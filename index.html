<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindful Labs (마인드풀랩스) - Coming Soon</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Sans+KR:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* --- Base Settings --- */
        :root { --cursor-size: 20px; }
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
            background-color: #050511; /* Ultra Deep Navy */
            color: #ffffff;
            overflow: hidden; height: 100vh; margin: 0;
        }
        /* --- Canvas --- */
        #neural-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; filter: contrast(120%) brightness(1.1); }
        /* --- Glassmorphism --- */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .glass-input {
            background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; color: white;
        }
        .glass-input:focus { background: rgba(0, 0, 0, 0.5); border-color: #2dd4bf; box-shadow: 0 0 15px rgba(45, 212, 191, 0.2); outline: none; }
        /* --- Typography --- */
        .gradient-text {
            background: linear-gradient(135deg, #ffffff 0%, #a5f3fc 50%, #2dd4bf 100%); -webkit-background-clip: text; background-clip: text; color: transparent;
            background-size: 200% 200%; animation: gradient-shift 8s ease infinite;
        }
        @keyframes gradient-shift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        /* --- Layout --- */
        .center-stage { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100%; max-width: 1200px; z-index: 10; padding: 2rem; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .korean-keep-all { word-break: keep-all; }
        /* --- Footer --- */
        .floating-footer { position: absolute; bottom: 2rem; left: 0; width: 100%; z-index: 20; font-size: 0.7rem; color: rgba(255, 255, 255, 0.3); transition: color 0.3s ease; }
        .floating-footer:hover { color: rgba(255, 255, 255, 0.6); }
        /* --- Tabs --- */
        .tab-btn { transition: all 0.3s ease; border-bottom: 2px solid transparent; color: rgba(255, 255, 255, 0.5); }
        .tab-btn.active { color: #fff; border-bottom-color: #2dd4bf; }
        .fade-enter { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <canvas id="neural-canvas"></canvas>

    <div class="center-stage">
        <!-- Brand -->
        <div class="mb-8 text-center opacity-0 animate-[fadeIn_1s_ease-out_forwards]">
            <p class="text-teal-400 text-sm tracking-[0.3em] uppercase font-semibold mb-4 animate-pulse">System Initializing...</p>
            <h1 class="text-5xl md:text-7xl font-black tracking-tighter text-white mb-2">Mindful <span class="font-light text-white/50">Labs</span></h1>
            <div class="h-1 w-24 bg-gradient-to-r from-teal-500 to-purple-600 mx-auto rounded-full"></div>
        </div>

        <!-- Main Panel -->
        <div class="glass-panel p-8 md:p-12 rounded-3xl max-w-2xl w-full text-center relative overflow-hidden opacity-0 animate-[fadeIn_1s_ease-out_0.5s_forwards]">
            <div class="absolute -top-20 -left-20 w-40 h-40 bg-teal-500/20 rounded-full blur-3xl pointer-events-none"></div>
            <div class="absolute -bottom-20 -right-20 w-40 h-40 bg-purple-500/20 rounded-full blur-3xl pointer-events-none"></div>

            <h2 class="text-3xl md:text-5xl font-bold mb-4 leading-tight korean-keep-all"><span class="gradient-text">AI, 마음을 만나다</span></h2>
            <p class="text-gray-300 text-lg md:text-xl font-light leading-relaxed mb-6 korean-keep-all">최고의 기술로 빚어내는<br>당신만의 마음챙김 솔루션</p>

            <!-- Tabs -->
            <div class="flex justify-center gap-8 mb-6 border-b border-white/10 pb-2">
                <button onclick="switchTab('waitlist')" id="tab-waitlist" class="tab-btn active pb-2 font-medium text-sm tracking-wider uppercase">사전 예약</button>
                <button onclick="switchTab('ai-demo')" id="tab-ai-demo" class="tab-btn pb-2 font-medium text-sm tracking-wider uppercase flex items-center gap-2"><span>✨ AI 마음챙김 체험</span></button>
            </div>

            <!-- Waitlist -->
            <div id="content-waitlist" class="fade-enter">
                <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-teal-900/30 border border-teal-500/20 mb-6">
                    <span class="relative flex h-2 w-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-teal-400 opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-teal-500"></span></span>
                    <span class="text-xs text-teal-200 font-medium tracking-wide">서비스 준비 중입니다.</span>
                </div>
                <form id="email-form" class="relative z-10 w-full max-w-md mx-auto flex flex-col gap-4">
                    <div class="relative group">
                        <input type="email" id="email-address" name="email" required placeholder="your-email@example.com" class="glass-input w-full px-6 py-4 rounded-xl placeholder-gray-500 text-center md:text-left">
                        <button type="submit" id="submit-button" class="mt-3 md:mt-0 md:absolute md:right-2 md:top-2 bg-white text-black font-bold px-6 py-2 md:h-[calc(100%-16px)] rounded-lg hover:bg-teal-50 transition-colors shadow-[0_0_20px_rgba(255,255,255,0.3)] hover:shadow-[0_0_30px_rgba(45,212,191,0.5)]">등록하기</button>
                    </div>
                    <p id="form-message" class="text-xs h-4 font-medium"></p>
                </form>
            </div>

            <!-- AI Demo -->
            <div id="content-ai-demo" class="hidden">
                <div class="w-full max-w-md mx-auto flex flex-col gap-4">
                    <p class="text-sm text-teal-200 mb-1 korean-keep-all">지금 당신의 마음 상태나 고민을 짧게 적어보세요.</p>
                    <div class="relative group w-full">
                        <textarea id="ai-input" rows="2" placeholder="예: 요즘 일이 너무 많아서 지쳐요..." class="glass-input w-full px-6 py-4 rounded-xl placeholder-gray-500 text-left resize-none"></textarea>
                        <button onclick="generateMindfulness()" id="ai-submit-btn" class="w-full mt-3 bg-gradient-to-r from-teal-500 to-blue-600 text-white font-bold px-6 py-3 rounded-xl hover:from-teal-400 hover:to-blue-500 transition-all shadow-lg flex items-center justify-center gap-2"><span>✨ AI에게 위로받기</span></button>
                    </div>
                    <div id="ai-result-container" class="hidden mt-4 text-left bg-white/5 rounded-xl p-6 border border-white/10">
                        <div class="flex items-start gap-3">
                            <div class="mt-1 p-1.5 bg-teal-500/20 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-teal-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg></div>
                            <div><h4 class="text-xs font-bold text-teal-400 uppercase tracking-wider mb-1">Mindful AI Insight</h4><p id="ai-response-text" class="text-sm text-gray-200 leading-relaxed ai-response"></p></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="floating-footer text-center">
        <div class="max-w-screen-xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-4 opacity-50 hover:opacity-100 transition-opacity duration-500">
            <div class="text-left"><p class="font-bold text-white/90">마인드풀랩스 주식회사 (Mindful Labs Inc.)</p></div>
            <div class="text-right flex flex-col gap-1 md:items-end text-gray-300"><p>사업자 등록번호: 786-88-03152 <span class="mx-2 text-white/20">|</span> 대표: 강호남</p><p>주소: 서울특별시 성동구 뚝섬로 13길 38, 4층 (성수동2가, KT&G상상플래닛)</p></div>
        </div>
    </footer>

    <script>
        console.log("Mindful Labs Secure Mode: v2.0 Loaded"); // 콘솔에서 버전 확인

        function switchTab(tabName) {
            const w = document.getElementById('content-waitlist'), a = document.getElementById('content-ai-demo');
            const wb = document.getElementById('tab-waitlist'), ab = document.getElementById('tab-ai-demo');
            if (tabName === 'waitlist') { w.classList.remove('hidden','fade-enter'); void w.offsetWidth; w.classList.add('fade-enter'); a.classList.add('hidden'); wb.classList.add('active'); ab.classList.remove('active'); }
            else { w.classList.add('hidden'); a.classList.remove('hidden','fade-enter'); void a.offsetWidth; a.classList.add('fade-enter'); wb.classList.remove('active'); ab.classList.add('active'); }
        }

        // Particle Animation
        const canvas = document.getElementById('neural-canvas'), ctx = canvas.getContext('2d');
        let width, height, particles = [], mouse = { x: null, y: null };
        const CONFIG = { count: 0, connDist: 140, mouseDist: 250, base: 'rgba(100, 200, 255, ', accent: 'rgba(45, 212, 191, ' };
        
        const resize = () => { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; CONFIG.count = Math.min(180, Math.floor((width*height)/9000)); init(); };
        class Particle {
            constructor() { this.x = Math.random()*width; this.y = Math.random()*height; this.vx = (Math.random()-0.5)*1.5; this.vy = (Math.random()-0.5)*1.5; this.s = Math.random()*2+1; this.acc = Math.random()>0.85; }
            up() {
                this.x+=this.vx; this.y+=this.vy; if(this.x<0||this.x>width)this.vx*=-1; if(this.y<0||this.y>height)this.vy*=-1;
                if(mouse.x){ let dx=mouse.x-this.x, dy=mouse.y-this.y, d=Math.sqrt(dx*dx+dy*dy); if(d<CONFIG.mouseDist){ let f=(CONFIG.mouseDist-d)/CONFIG.mouseDist; this.vx-=dx/d*f*0.1; this.vy-=dy/d*f*0.1; } }
            }
            draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.s, 0, Math.PI*2); ctx.fillStyle = this.acc?CONFIG.accent+'1)':CONFIG.base+'0.8)'; ctx.fill(); }
        }
        function init(){ particles=[]; for(let i=0;i<CONFIG.count;i++) particles.push(new Particle()); }
        function anim(){ 
            ctx.clearRect(0,0,width,height); 
            for(let i=0; i<particles.length; i++){
                particles[i].up(); particles[i].draw();
                for(let j=i; j<particles.length; j++){
                    let dx=particles[i].x-particles[j].x, dy=particles[i].y-particles[j].y, d=Math.sqrt(dx*dx+dy*dy);
                    if(d<CONFIG.connDist){ ctx.strokeStyle=CONFIG.base+(1-d/CONFIG.connDist)*0.15+')'; ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo(particles[i].x, particles[i].y); ctx.lineTo(particles[j].x, particles[j].y); ctx.stroke(); }
                }
            } requestAnimationFrame(anim); 
        }
        window.addEventListener('resize', resize); window.addEventListener('mousemove', e=>{mouse.x=e.x;mouse.y=e.y}); window.addEventListener('mouseout', ()=>{mouse.x=null;mouse.y=null}); resize(); anim();

        // Google Sheets
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw_EnCJEZq4xM8jn0NXwg-mwk6KbOwU0s9eJgJK5mAeRxHjPVFwEE2e-79zs4nk4r99sA/exec';
        const form = document.getElementById('email-form'), msg = document.getElementById('form-message'), sbtn = document.getElementById('submit-button');
        window.handleResponse = d => { msg.textContent = d.result==='success'?'이메일 등록 성공!':'오류: '+(d.message||'알 수 없음'); msg.className = d.result==='success'?'text-xs h-4 font-bold text-teal-400':'text-xs h-4 font-bold text-red-400'; sbtn.disabled=false; sbtn.innerHTML='등록하기'; if(document.getElementById('jsonp'))document.body.removeChild(document.getElementById('jsonp')); form.reset(); };
        form.addEventListener('submit', e => { e.preventDefault(); const v=document.getElementById('email-address').value; if(!v||!v.includes('@'))return; sbtn.disabled=true; sbtn.innerHTML='...'; const s=document.createElement('script'); s.id='jsonp'; s.src=`${SCRIPT_URL}?email=${encodeURIComponent(v)}&callback=handleResponse`; document.body.appendChild(s); });

        // ★★★ SECURE AI FUNCTION ★★★
        async function generateMindfulness() {
            const input = document.getElementById('ai-input').value;
            const btn = document.getElementById('ai-submit-btn');
            const resDiv = document.getElementById('ai-result-container');
            const resTxt = document.getElementById('ai-response-text');

            if (!input.trim()) { alert("내용을 입력해주세요."); return; }

            btn.disabled = true; btn.innerHTML = '<span class="animate-spin inline-block mr-2">✨</span> 생각 중...';
            resDiv.classList.add('hidden');

            try {
                // 여기가 핵심입니다: Google이 아닌 Netlify Function으로 요청을 보냅니다.
                const response = await fetch('/.netlify/functions/gemini', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: input })
                });

                if (!response.ok) {
                    // Netlify Function이 실패했을 때 (404, 500 등)
                    throw new Error(`Server Error: ${response.status}`);
                }

                const data = await response.json();
                resTxt.innerText = data.reply;
                resDiv.classList.remove('hidden'); resDiv.classList.add('fade-enter');

            } catch (error) {
                console.error('Secure Function Error:', error);
                alert("오류가 발생했습니다. (잠시 후 다시 시도해주세요)");
            } finally {
                btn.disabled = false; btn.innerHTML = '<span>✨ AI에게 위로받기</span>';
            }
        }
    </script>
</body>
</html>